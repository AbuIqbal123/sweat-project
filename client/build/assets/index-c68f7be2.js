import{r as t,j as e,a as de}from"./react-30d6747a.js";import{c as Le}from"./react-dom-13020a9b.js";import{M as je,F as ge,a as Ke,I as qe}from"./react-icons-ccb83855.js";import{B as A,Q as ze}from"./react-toastify-0ad78e1f.js";import{C as ce,T as ue,B as ie,a as le,F as V,I as Z,S as ne,P as Ye}from"./antd-f4f9c9f9.js";import{a as me}from"./axios-28bc18a3.js";import{L as Ve,B as Ge}from"./react-router-dom-1db58179.js";import{b as Ue,a as fe,d as Xe,e as Qe,f as ae}from"./react-router-5f5873ff.js";import Je from"./html2canvas-e0a7d97b.js";import{R as Ce,L as Me,C as Ae,X as Se,a as oe,Y as we,b as ke,T as Ne,c as _,B as Ze,A as et,d as tt,e as st}from"./recharts-a452ce2a.js";import{$ as at}from"./react-to-pdf-68ec3a16.js";import{d as rt,I as We,a as lt,b as nt}from"./@mui-8e6662e5.js";import{S as xe}from"./react-select-936f189c.js";import"./@babel-4c4c4ede.js";import"./scheduler-765c72db.js";import"./clsx-0839fdbe.js";import"./rc-util-eb9ad177.js";import"./@ant-design-329a6b49.js";import"./@emotion-18ba1ff4.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./stylis-fad5b415.js";import"./classnames-51c89ac5.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@ctrl-fb5a5473.js";import"./rc-resize-observer-c69e3db4.js";import"./rc-motion-332894bc.js";import"./rc-menu-ee1ebdc9.js";import"./rc-overflow-83108d31.js";import"./@rc-component-297a9809.js";import"./rc-select-3bddeea6.js";import"./rc-virtual-list-42099485.js";import"./rc-field-form-01f3d7e5.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-582d6ca4.js";import"./compute-scroll-into-view-e3f0ecc2.js";import"./rc-progress-d4ad216a.js";import"./rc-table-0057a503.js";import"./rc-pagination-7eee4a56.js";import"./rc-picker-7afac018.js";import"./throttle-debounce-87e7e444.js";import"./rc-checkbox-7fb5cc3d.js";import"./rc-dropdown-507df074.js";import"./rc-tooltip-59464379.js";import"./rc-tree-4ad55cb4.js";import"./rc-input-ddedde2b.js";import"./rc-textarea-b109f95f.js";import"./@remix-run-3bbc17b4.js";import"./react-resize-detector-02812ea4.js";import"./lodash-c152415b.js";import"./react-smooth-86e6e00b.js";import"./prop-types-9273a8c3.js";import"./fast-equals-a0711cdd.js";import"./tiny-invariant-bee4f299.js";import"./victory-vendor-5e3e398c.js";import"./d3-scale-4cce9527.js";import"./internmap-7949acc8.js";import"./d3-array-7d9b19f9.js";import"./d3-time-format-aa787c71.js";import"./d3-time-9ce187c0.js";import"./d3-interpolate-8fa1f6ff.js";import"./d3-color-6502c434.js";import"./d3-format-ffdb8652.js";import"./recharts-scale-170b47f7.js";import"./decimal.js-light-6fe16ef2.js";import"./d3-shape-9e788a4f.js";import"./d3-path-41c4cb36.js";import"./eventemitter3-59f966be.js";import"./jspdf-284e01de.js";import"./fflate-8981c52c.js";import"./@floating-ui-1f780445.js";import"./use-isomorphic-layout-effect-de8c90f4.js";import"./memoize-one-297ddbcb.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))h(c);new MutationObserver(c=>{for(const f of c)if(f.type==="childList")for(const x of f.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&h(x)}).observe(document,{childList:!0,subtree:!0});function l(c){const f={};return c.integrity&&(f.integrity=c.integrity),c.referrerPolicy&&(f.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?f.credentials="include":c.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function h(c){if(c.ep)return;c.ep=!0;const f=l(c);fetch(c.href,f)}})();const it={},re=t.createContext(it);function ot(s){const[r,l]=t.useState("Student"),[h,c]=t.useState({}),[f,x]=t.useState(),[o,y]=t.useState(),[v,n]=t.useState(0),u=t.useMemo(()=>({setIsStudent:l,setPdfPreviewData:c,setFiltersData:y,setRefetch:n,setGraphSS:x,pdfPreviewData:h,filtersData:o,isStudent:r,refetch:v,graphSS:f}),[r,o,v,h,f]);return e.jsx(re.Provider,{value:u,children:s.children})}const He=de.createContext(null),dt=({index:s,...r})=>{const[l]=V.useForm();return e.jsx(V,{form:l,component:!1,children:e.jsx(He.Provider,{value:l,children:e.jsx("tr",{...r})})})},ct=({title:s,editable:r,children:l,dataIndex:h,record:c,handleSave:f,...x})=>{const[o,y]=t.useState(r||!1),v=t.useRef(null),n=t.useContext(He);t.useEffect(()=>{var a;r&&o&&((a=v==null?void 0:v.current)==null||a.focus())},[o]);const u=()=>{y(!o),n.setFieldsValue({[h]:c[h]})},i=async()=>{try{const a=await n.validateFields();u(),f({...c,...a})}catch(a){console.log("Save failed:",a)}};let m=l;return r&&(m=o?e.jsx(V.Item,{style:{margin:0},name:h,rules:[{required:!0,message:`${s} is required.`}],children:e.jsx("div",{children:e.jsx(Z,{ref:v,onPressEnter:i,onBlur:i,placeholder:"No of hours"})})}):e.jsx("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:u,children:l})),e.jsx("td",{...x,children:m})},ut=s=>{const[r,l]=t.useState([{key:"0",lectures:"No of hours",seminars:"No of hours",tutorials:"No of hours",labs:"No of hours",fieldwork_placement:"No of hours",other:"No of hours"}]),[h,c]=t.useState(!1),f=[{title:"Lectures",dataIndex:"lectures",editable:h,required:!0,render:n=>e.jsx("p",{style:{color:"white"},children:n})},{title:"Seminars",dataIndex:"seminars",editable:h,render:n=>e.jsx("p",{style:{color:"white"},children:n})},{title:"Tutorials",dataIndex:"tutorials",editable:h,render:n=>e.jsx("p",{style:{color:"white"},children:n})},{title:"Labs",dataIndex:"labs",editable:h,render:n=>e.jsx("p",{style:{color:"white"},children:n})},{title:"Fieldwork Placement",dataIndex:"fieldwork_placement",width:"10%",editable:h,render:n=>e.jsx("p",{style:{color:"white"},children:n})},{title:"Other",dataIndex:"other",editable:h,render:n=>e.jsx("p",{style:{color:"white"},children:n})},{title:"Edit",dataIndex:"operation",render:n=>r.length>=1?e.jsx("div",{style:{display:"flex",gap:"10px"},children:e.jsx("p",{onClick:()=>c(!h),style:{color:"white",cursor:"pointer",title:"Edit Schedule"},children:e.jsx(le,{title:h?"Save":"Edit",children:h?e.jsx(ge,{}):e.jsx(je,{})})})}):null}],x=()=>{const{fieldwork_placement:n,key:u,labs:i,lectures:m,other:a,programme:g,semester:S,seminars:d,tutorials:w,studyYear:I,title:B}=r[0],L={programme:g,semester:S,studyYear:I,title:B},H={fieldwork_placement:n,key:u,labs:i,lectures:m,other:a,tutorials:w,seminars:d};if(!Object.values(H).every(T=>!isNaN(T))){A.error("No of hours required for all fields. Please enter valid numbers");return}Object.values(H).filter(T=>!isNaN(T)).reduce((T,O)=>T+parseFloat(O),0)!==parseInt(s==null?void 0:s.hours)?A.error("Hours are not equal to the timetabled hours"):(A.success("Teaching data successfully saved"),s==null||s.setError(!1),s==null||s.setTeachingData({...r[0],bypassValues:L}))},o=n=>{const u=[...r],i=u.findIndex(a=>n.key===a.key),m=u[i];u.splice(i,1,{...m,...n}),l(u)},y={body:{row:dt,cell:ct}},v=f.map(n=>n.editable?{...n,onCell:u=>({record:u,editable:n==null?void 0:n.editable,dataIndex:n.dataIndex,title:n.title,handleSave:o})}:n);return e.jsxs("div",{children:[e.jsx(ce,{theme:{components:{Table:{headerColor:"white",headerBg:"#27496d",borderColor:"white",rowHoverBg:"none",rowBg:"#051650",colorBgContainer:"#051650"}}},children:e.jsx(ue,{components:y,rowClassName:()=>"editable-row",bordered:!0,pagination:!1,dataSource:r,columns:v})}),e.jsx(ie,{onClick:x,danger:s==null?void 0:s.error,style:{color:"#051650",backgroundColor:"white",fontWeight:"bold",border:"2px solid #b10062",marginTop:"1rem"},children:"Save"})]})},{Option:ye}=ne,_e=de.createContext(null),ht=({index:s,...r})=>{const[l]=V.useForm();return e.jsx(V,{form:l,component:!1,children:e.jsx(_e.Provider,{value:l,children:e.jsx("tr",{...r})})})},mt=({title:s,editable:r,children:l,dataIndex:h,record:c,handleSave:f,...x})=>{const[o,y]=t.useState(!1),v=t.useRef(null),n=t.useContext(_e);t.useEffect(()=>{o&&v.current.focus()},[o]);const u=()=>{y(!o),n.setFieldsValue({[h]:c[h]})},i=async()=>{try{const a=await n.validateFields();u(),f({...c,...a})}catch(a){console.log("Save failed:",a)}};let m=l;return r&&(m=o?e.jsx(V.Item,{style:{margin:0},name:h,rules:[{required:!0,message:`${s} is required.`}],children:h==="type"?e.jsxs(ne,{ref:v,onPressEnter:i,onBlur:i,children:[e.jsx(ye,{value:"courseWork",children:"Course Work"}),e.jsx(ye,{value:"classTest",children:"Class Test"})]}):h==="deadline"?e.jsx(ne,{ref:v,onPressEnter:i,onBlur:i,children:Array.from({length:15},(a,g)=>g+1).map(a=>e.jsxs(ye,{value:`Week${a}`,children:["Week ",a]},a))}):e.jsx("div",{children:e.jsx(Z,{ref:v,onPressEnter:i,onBlur:i,placeholder:"Percentage"})})}):e.jsx("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:u,children:l})),e.jsx("td",{...x,children:m})},xt=s=>{const[r,l]=t.useState([{key:"0",type:"Exam",weightage:"Percentage",deadline:"Week15"}]),[h,c]=t.useState(!1),[f,x]=t.useState(2),o=g=>{if(g==="0")return;const S=r.filter(d=>d.key!==g);l(S)},y=[{title:"Type",dataIndex:"type",width:"30%",editable:h,render:g=>e.jsx("p",{style:{color:"white"},children:g})},{title:"Weightage (%)",dataIndex:"weightage",editable:h,render:g=>e.jsx("p",{style:{color:"white"},children:g})},{title:"Deadline (Week)",dataIndex:"deadline",editable:h,render:g=>e.jsx("p",{style:{color:"white"},children:g})},{title:"Edit",dataIndex:"operation",render:(g,S)=>r.length>=1?e.jsxs("div",{style:{display:"flex",gap:"20px"},children:[e.jsx("p",{onClick:()=>c(!h),style:{color:"white",cursor:"pointer"},children:e.jsx(le,{title:h?"Save":"Edit",children:h?e.jsx(ge,{}):e.jsx(je,{})})}),(S==null?void 0:S.key)===parseInt(S==null?void 0:S.key)&&e.jsx("p",{onClick:()=>{o(S.key)},style:{color:"white",cursor:"pointer"},children:e.jsx(le,{title:"Delete",children:e.jsx(Ke,{})})}),e.jsx("p",{onClick:()=>u(),style:{color:"white",cursor:"pointer"},children:e.jsx(le,{title:"Add",children:e.jsx(qe,{})})})]}):null}],v=g=>{const S={examPrep:{},courseworkPrep:[],classtestPrep:[]};return g.forEach(d=>{const w={weightage:parseFloat(d.weightage),deadline:parseInt(d.deadline.replace("Week",""),10)};d.type==="Exam"?S.examPrep=w:d.type==="Course Work"||d.type==="courseWork"?S.courseworkPrep.push(w):d.type==="classTest"&&S.classtestPrep.push(w)}),S},n=()=>{if(!r.every(d=>!isNaN(parseFloat(d.weightage)))){A.error("Weightage must be a number for all entries");return}if(r.reduce((d,w)=>d+parseFloat(w.weightage),0)!==100){A.error("The sum of weightages must be equal to 100");return}A.success("Assessments data successfully saved"),s==null||s.setError(!1),s==null||s.setAssessmentsData(v(r))},u=()=>{const g={key:f,type:"Course Work",weightage:"Percentage",deadline:"Week1",editable:h};l([...r,g]),x(f+1)},i=g=>{const S=[...r],d=S.findIndex(I=>g.key===I.key),w=S[d];S.splice(d,1,{...w,...g}),l(S)},m={body:{row:ht,cell:mt}},a=y.map(g=>g.editable?{...g,onCell:S=>({record:S,editable:!(S.key==="0"&&(g.dataIndex==="type"||g.dataIndex==="deadline")),dataIndex:g.dataIndex,title:g.title,handleSave:i})}:g);return e.jsxs("div",{children:[e.jsx(ce,{theme:{components:{Table:{headerColor:"white",headerBg:"#27496d",borderColor:"white",rowHoverBg:"none",rowBg:"#051650",colorBgContainer:"#051650"}}},children:e.jsx(ue,{components:m,rowClassName:()=>"editable-row",bordered:!0,pagination:!1,dataSource:r,columns:a})}),e.jsx(ie,{onClick:n,danger:s==null?void 0:s.error,style:{color:"#051650",backgroundColor:"white",fontWeight:"bold",border:"2px solid #b10062",marginTop:"1rem"},children:"Save"})]})},te={_url:"https://sweat-e00334d180ef.herokuapp.com",async getCodes(s){return await me.get(`${this._url}/module/fetch-all-codes?${s}`)},async getSingleCode(s){return await me.get(`${this._url}/module/fetch-data/`+s)},async updateCodes(s,r){return await me.put(`${this._url}/module/update/${s}`,r)},async createCodes(s){return await me.post(`${this._url}/module/create`,s)}},pt=()=>{const s=[{title:"7.5",value:"7.5"},{title:"15",value:"15"}],r=[{title:1,value:1},{title:2,value:2},{title:3,value:3}],l=[{title:"First",value:"first"},{title:"Second",value:"second"},{title:"Whole Session",value:"whole session"}],[h,c]=t.useState(null),[f,x]=t.useState(7.5),[o,y]=t.useState(null),[v,n]=t.useState(),[u,i]=t.useState(),[m,a]=t.useState(1),[g,S]=t.useState("first"),[d,w]=t.useState(!1),[I,B]=t.useState([]),[L,H]=t.useState(),[E,R]=t.useState(!1),[T,O]=t.useState(!1),G=j=>{try{return{moduleCode:j.code,moduleCredit:j.credits,timetabledHours:parseInt(j.timetabledHours,10),semester:g,title:u,programme:I,studyYear:m,optional:d,lectures:parseInt(j.teachingsData.lectures,10),seminars:parseInt(j.teachingsData.seminars,10),tutorials:parseInt(j.teachingsData.tutorials,10),labs:parseInt(j.teachingsData.labs,10),fieldworkPlacement:parseInt(j.teachingsData.fieldwork_placement,10),other:parseInt(j.teachingsData.other,10),examPrep:{weightage:j.assessmentsData.examPrep.weightage,deadline:j.assessmentsData.examPrep.deadline},courseworkPrep:j.assessmentsData.courseworkPrep.map(N=>({weightage:N.weightage,deadline:N.deadline})),classtestPrep:j.assessmentsData.classtestPrep.map(N=>({weightage:N.weightage,deadline:N.deadline}))}}catch(N){console.log(N)}},$=async j=>{try{const N=await te.createCodes(j);N&&(A.success(N==null?void 0:N.data),setTimeout(()=>{window.location.reload()},2500))}catch(N){A.error(N)}},J=()=>{if(!v){A.error("Please save the schedule fields!"),R(!0);return}if(!L){A.error("Please save the assessments data!"),O(!0);return}$(G({teachingsData:v,assessmentsData:L,timetabledHours:h,credits:f,code:o}))},U=j=>{j.target.checked?B([...I,j.target.name]):B(I==null?void 0:I.filter(N=>N!==j.target.name))};return e.jsx("div",{className:"rootContainer",children:e.jsxs("div",{className:"rootc",children:[e.jsxs("div",{className:"rootn",children:[e.jsx("div",{className:"heading",children:e.jsx("h1",{children:"Input Module Details"})}),e.jsxs("div",{className:"inputContainer",children:[e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"Module Code"}),e.jsx("div",{className:"mutipleInput",children:e.jsx(Z,{onChange:j=>y(j.target.value),placeholder:"Enter Module Code",status:o?"":"error"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"Module Credit"}),e.jsx("div",{id:"Credit",className:"inputSize",children:e.jsx("select",{name:"credit",className:"select_field",id:"credit",onChange:j=>x(j.target.value),children:s==null?void 0:s.map((j,N)=>{var b;return e.jsx("option",{value:j==null?void 0:j.value,defaultValue:(b=s[0])==null?void 0:b.value,children:j.title},N)})})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"TimeTabled Hours"}),e.jsx("div",{id:"timetable",className:"mutipleInput",children:e.jsx(Z,{onChange:j=>c(j.target.value),placeholder:"Enter Timetabled Hours",status:h?"":"error"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"Title"}),e.jsx("div",{className:"mutipleInput",children:e.jsx(Z,{onChange:j=>i(j.target.value),placeholder:"Enter Module Code",status:u?"":"error"})})]})]}),e.jsxs("div",{className:"inputContainer",children:[e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"Study Year"}),e.jsx("div",{id:"Credit",className:"inputSize",children:e.jsx("select",{name:"credit",className:"select_field",id:"credit",onChange:j=>a(j.target.value),children:r==null?void 0:r.map((j,N)=>{var b;return e.jsx("option",{value:j==null?void 0:j.value,defaultValue:(b=s[0])==null?void 0:b.value,children:j.title},N)})})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"Programme"}),e.jsxs("div",{id:"Programme",className:"programme_checkboxes",children:[e.jsxs("div",{children:[e.jsxs("label",{children:[e.jsx("input",{name:"CSEE",type:"checkbox",onChange:U}),"CSEE"]}),e.jsxs("label",{children:[e.jsx("input",{name:"AVS",type:"checkbox",onChange:U}),"AVS"]})]}),e.jsxs("div",{children:[e.jsxs("label",{children:[e.jsx("input",{name:"MCR",type:"checkbox",onChange:U}),"MCR"]}),e.jsxs("label",{children:[e.jsx("input",{name:"EEE",type:"checkbox",onChange:U}),"EEE"]})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"Semester"}),e.jsx("div",{id:"Semester",className:"inputSize",children:e.jsx("select",{name:"Semester",id:"semester",className:"select_field",onChange:j=>S(j.target.value),children:l==null?void 0:l.map((j,N)=>{var b;return e.jsx("option",{value:j==null?void 0:j.value,defaultValue:(b=s[0])==null?void 0:b.value,children:j.title},N)})})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",children:"Optional"}),e.jsx("div",{id:"Credit",className:"inputSize",children:e.jsx("select",{className:"select_field",name:"credit",id:"credit",onChange:j=>w(j.target.value),children:[{title:"False",value:!1},{title:"True",value:!0}].map((j,N)=>{var b;return e.jsx("option",{value:j==null?void 0:j.value,defaultValue:(b=s[0])==null?void 0:b.value,children:j.title},N)})})})]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"90%",paddingLeft:"5%"},className:"textui",children:[e.jsx("h1",{children:"Teaching Schedule"}),e.jsx(ut,{credits:f,hours:h,code:o,setTeachingData:n,error:E,setError:R})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"90%",paddingLeft:"5%"},className:"textui",children:[e.jsx("h1",{children:"Assessments Schedule"}),e.jsx(xt,{credits:f,hours:h,code:o,setAssessmentsData:H,error:T,setError:O})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(ie,{onClick:J,style:{color:"#051650",backgroundColor:"white",fontWeight:"bold",border:"2px solid #b10062"},children:"Submit"})})]})})};const jt=()=>{const{isStudent:s,setIsStudent:r}=t.useContext(re),l=Ue(),h=[{title:"Home",link:"/"},{title:"Modules",link:"/previous-courses"},{title:"Input Modules",link:"/select-course"},{title:"Simulations",link:"/simulations"},{title:"Stacked Simulations",link:"/stacked-simulations"}];return e.jsx("div",{className:"cont",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"logo",children:e.jsx("h1",{style:{fontFamily:"Benzin-Medium"},children:"Sweat"})}),e.jsx("div",{className:"links",children:e.jsxs("ul",{children:[h.map((c,f)=>s==="Student"&&c.title==="Input Modules"?null:e.jsx("li",{children:e.jsx(Ve,{to:c.link,className:l.pathname===c.link?"link-active":"link",children:c.title})},f)),e.jsxs("li",{className:"role-dropdown",children:[" ",e.jsx("label",{htmlFor:"is_student",children:"Role:"}),e.jsxs("select",{className:"navDropDown",name:"is_student",id:"is_student",onChange:c=>r(c.target.value),value:s,children:[e.jsx("option",{value:"Student",children:"Student"}),e.jsx("option",{value:"Admin",children:"Admin"})]})]})]})})]})})};const gt=()=>{const{isStudent:s}=t.useContext(re),r=fe();return e.jsx("div",{className:"main-div",children:e.jsxs("div",{className:"div2",children:[e.jsx("h1",{children:"Student Workload Impact Evolution Tool"}),e.jsx("p",{className:"description",children:"This tool helps predict the academic workload for students, streamlining curriculum planning for educators. It offers insights into the effects of coursework on students' time and resources."}),e.jsxs("div",{className:"btnContainer",children:[" ",e.jsx("div",{className:"btn1",children:e.jsxs("button",{onClick:()=>r("/previous-courses"),children:[e.jsx("span",{children:"Modules"}),e.jsx("i",{})]})}),s==="Admin"&&e.jsx("div",{className:"btn2",children:e.jsxs("button",{onClick:()=>r("/select-course"),children:[e.jsx("span",{children:"Add a module"}),e.jsx("i",{})]})})]})]})})};const ft=()=>{const[s,r]=t.useState([]),[l,h]=t.useState("All"),[c,f]=t.useState("All"),[x,o]=t.useState("All"),[y,v]=t.useState([]),n=fe(),{setPdfPreviewData:u,setFiltersData:i,setGraphSS:m}=t.useContext(re),a=[{title:"Module Code",dataIndex:"moduleCode",align:"center",color:"white",render:d=>e.jsx("p",{style:{color:"white"},children:d})},{title:"Title",dataIndex:"title",align:"center",render:d=>e.jsx("p",{style:{color:"white"},children:d})},{title:"Credit Value",dataIndex:"moduleCredit",align:"center",render:d=>e.jsx("p",{style:{color:"white"},children:d})},{title:"Semester",dataIndex:"semester",align:"center",render:d=>e.jsx("p",{style:{color:"white"},children:d})},{title:"Programmes",dataIndex:"programme",align:"center",render:d=>e.jsx("p",{style:{color:"white"},children:d})},{title:"Insights",dataIndex:"insights",align:"center",render:d=>e.jsx("p",{style:{textDecoration:"underline",cursor:"pointer",fontWeight:"bold",color:"white"},onClick:()=>n(`/insight/${d}`),children:"View Insights"})}],g={semester:c,course:x,year:l};t.useEffect(()=>{(async()=>{try{const d=new URLSearchParams(g),w=await te.getCodes(d);v(w.data);const I=w.data.map(B=>{var R,T;const{_id:L,...H}=B,E={key:L,...H,insights:H==null?void 0:H.moduleCode};return(R=E==null?void 0:E.programme)!=null&&R.length&&(E.programme=(T=E==null?void 0:E.programme)==null?void 0:T.map((O,G)=>{var $;return(($=E==null?void 0:E.programme)==null?void 0:$.length)-1>G?`${O}, `:O})),E});r(I)}catch(d){console.log({e:d})}})()},[l,c,x]);const S=()=>{y!=null&&y.length&&(i({yearFilter:l,semesterFilter:c,courseFilter:x}),m(),u(y),n("/preview-pdf"))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{textAlign:"center",marginTop:"65px",marginBottom:"-15px",marginLeft:"50px"},children:[e.jsx("label",{style:{color:"white",marginRight:"8px"},children:"Year:"}),e.jsxs("select",{className:"navDropDown",name:"is_student",style:{marginRight:"20px",backgroundColor:"#1c4966",color:"white"},id:"is_student",onChange:d=>h(d.target.value),children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"1"}),e.jsx("option",{children:"2"}),e.jsx("option",{children:"3"})]}),e.jsx("label",{style:{color:"white",marginRight:"8px"},children:"Semester:"}),e.jsxs("select",{className:"navDropDown",name:"is_student",style:{marginRight:"20px",backgroundColor:"#1c4966",color:"white"},id:"is_student",onChange:d=>f(d.target.value),children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"First"}),e.jsx("option",{children:"Second"}),e.jsx("option",{children:"Whole Session"})]}),e.jsx("label",{style:{color:"white",marginRight:"8px"},children:"Course:"}),e.jsxs("select",{className:"navDropDown",name:"is_student",style:{backgroundColor:"#1c4966",color:"white"},id:"is_student",onChange:d=>o(d.target.value),children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"CSEE"}),e.jsx("option",{children:"AVS"}),e.jsx("option",{children:"MCR"}),e.jsx("option",{children:"EEE"})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#ffffff00"},children:e.jsx(ce,{theme:{components:{Table:{headerColor:"white",headerBg:"#27496d",borderColor:"white",rowHoverBg:"none",rowBg:"#051650",colorBgContainer:"#051650"}}},children:e.jsx(ue,{style:{paddingTop:"4rem",marginBottom:"50px",height:"auto",width:"auto"},columns:a,dataSource:s,bordered:!0,pagination:{pageSize:6}})})}),e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsxs("button",{className:"pdfButton",onClick:S,children:[e.jsx("span",{children:"Preview PDF"}),e.jsx("i",{})]})})]})};function vt(){const[s,r]=t.useState([0,0]);return t.useEffect(()=>{function l(){r([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",l),l(),()=>window.removeEventListener("resize",l)},[]),s}const pe=({percentage:s,color:r})=>{const[l,h]=vt(),c=l<480?80:l<768?90:100,f=l<480?8:l<768?10:12;return e.jsx("div",{className:"circular-progress",children:e.jsx(Ye,{type:"circle",percent:s,width:c,strokeColor:r,strokeWidth:f,format:()=>e.jsx("p",{style:{color:"white"},children:`${s}%`})})})};const Be=de.createContext(null),yt=({index:s,...r})=>{const[l]=V.useForm();return e.jsx(V,{form:l,component:!1,children:e.jsx(Be.Provider,{value:l,children:e.jsx("tr",{...r})})})},bt=({title:s,editable:r,children:l,dataIndex:h,record:c,handleSave:f,...x})=>{const[o,y]=t.useState(!1),v=t.useRef(null),n=t.useContext(Be);t.useEffect(()=>{o&&v.current.focus()},[o]);const u=()=>{y(!o),n.setFieldsValue({[h]:c[h]})},i=async()=>{try{const a=await n.validateFields();u(),f({...c,...a})}catch(a){console.log("Save failed:",a)}};let m=l;return r&&(m=o?e.jsx(V.Item,{style:{margin:0},name:h,rules:[{required:!0,message:`${s} is required.`}],children:e.jsx(Z,{ref:v,onPressEnter:i,onBlur:i})}):e.jsx("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:u,children:l})),e.jsx("td",{...x,children:m})},Ct=({hours:s,newValues:r,hoursData:l,setTeachingsData:h})=>{const c={...s,...r},[f,x]=t.useState([c]),[o,y]=t.useState(!1),v=[{title:"Lectures",dataIndex:"lectures",editable:o,render:a=>e.jsx("p",{style:{color:"white"},children:a})},{title:"Seminars",dataIndex:"seminars",editable:o,render:a=>e.jsx("p",{style:{color:"white"},children:a})},{title:"Tutorials",dataIndex:"tutorials",editable:o,render:a=>e.jsx("p",{style:{color:"white"},children:a})},{title:"Labs",dataIndex:"labs",editable:o,render:a=>e.jsx("p",{style:{color:"white"},children:a})},{title:"Fieldwork Placement",dataIndex:"fieldworkPlacement",width:"8%",editable:o,render:a=>e.jsx("p",{style:{color:"white"},children:a})},{title:"Other",dataIndex:"other",editable:o,render:a=>e.jsx("p",{style:{color:"white"},children:a})},{title:"Edit",dataIndex:"operation",render:a=>f.length>=1?e.jsx("div",{style:{display:"flex",gap:"10px"},children:e.jsx("p",{onClick:()=>y(!o),style:{color:"white",cursor:"pointer",title:"Edit Schedule"},children:e.jsx(le,{title:o?"Save":"Edit",children:o?e.jsx(ge,{}):e.jsx(je,{})})})}):null}],n=()=>{let{fieldworkPlacement:a,labs:g,lectures:S,other:d,programme:w,semester:I,seminars:B,tutorials:L,studyYear:H,title:E}=f[0];const R={programme:w,semester:I,studyYear:H,title:E},T={fieldworkPlacement:a,labs:g,lectures:S,other:d,tutorials:L,seminars:B};if(!Object.values(T).every($=>!isNaN($))){A.error("No of hours required for all fields. Please enter valid numbers");return}Object.values(T).filter($=>!isNaN($)).reduce(($,J)=>$+parseFloat(J),0)!==parseInt(l)?A.error("Hours are not equal to the timetabled hours"):(A.success("Data Saved Successfully"),h({...T,...R}))},u=a=>{const g=[...f],S=g.findIndex(w=>a.key===w.key),d=g[S];g.splice(S,1,{...d,...a}),x(g)},i={body:{row:yt,cell:bt}},m=v.map(a=>a.editable?{...a,onCell:g=>({record:g,editable:a.editable,dataIndex:a.dataIndex,title:a.title,handleSave:u})}:a);return e.jsxs("div",{children:[e.jsx(ce,{theme:{components:{Table:{headerColor:"white",headerBg:"#27496d",borderColor:"white",rowHoverBg:"none",rowBg:"#051650",colorBgContainer:"#051650"}}},children:e.jsx(ue,{components:i,rowClassName:()=>"editable-row",bordered:!0,pagination:!1,dataSource:f,columns:m})}),e.jsx(ie,{onClick:n,style:{color:"#051650",backgroundColor:"white",fontWeight:"bold",border:"2px solid #b10062",marginTop:"1rem"},children:"Save"})]})},{Option:be}=ne,$e=de.createContext(null),St=({index:s,...r})=>{const[l]=V.useForm();return e.jsx(V,{form:l,component:!1,children:e.jsx($e.Provider,{value:l,children:e.jsx("tr",{...r})})})},wt=({title:s,editable:r,children:l,dataIndex:h,record:c,handleSave:f,...x})=>{const[o,y]=t.useState(!1),v=t.useRef(null),n=t.useContext($e);t.useEffect(()=>{o&&v.current.focus()},[o]);const u=()=>{y(!o),n.setFieldsValue({[h]:c[h]})},i=async()=>{try{const a=await n.validateFields();u(),f({...c,...a})}catch(a){console.log("Save failed:",a)}};let m=l;return r&&(m=o?e.jsx(V.Item,{style:{margin:0},name:h,rules:[{required:!0,message:`${s} is required.`}],children:h==="type"?e.jsxs(ne,{ref:v,onPressEnter:i,onBlur:i,children:[e.jsx(be,{value:"Course Work",children:"Course Work"}),e.jsx(be,{value:"Class Test",children:"Class Test"})]}):h==="deadline"?e.jsx(ne,{ref:v,onPressEnter:i,onBlur:i,children:Array.from({length:15},(a,g)=>g+1).map(a=>e.jsxs(be,{value:`Week${a}`,children:["Week ",a]},a))}):e.jsx(Z,{ref:v,onPressEnter:i,onBlur:i})}):e.jsx("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:u,children:l})),e.jsx("td",{...x,children:m})},kt=({data:s,setAssessmentsData:r})=>{const[l,h]=t.useState(s),[c,f]=t.useState(!1),x=[{title:"Type",dataIndex:"type",width:"30%",editable:c,render:i=>e.jsx("p",{style:{color:"white"},children:i})},{title:"Weightage (%)",dataIndex:"weightage",editable:c,render:i=>e.jsx("p",{style:{color:"white"},children:i})},{title:"Deadline (Week)",dataIndex:"deadline",editable:c,render:i=>e.jsx("p",{style:{color:"white"},children:i})},{title:"Edit",dataIndex:"operation",render:i=>l.length>=1?e.jsx("div",{style:{display:"flex",gap:"20px"},children:e.jsx("p",{onClick:()=>f(!c),style:{color:"white",cursor:"pointer"},children:e.jsx(le,{title:c?"Save":"Edit",children:c?e.jsx(ge,{}):e.jsx(je,{})})})}):null}],o=i=>{const m={examPrep:{},courseworkPrep:[],classtestPrep:[]};return i.forEach(a=>{const g={weightage:parseFloat(a.weightage),deadline:parseInt(a.deadline.replace("Week",""),10)};a.type==="Exam"?m.examPrep=g:a.type==="courseWork"||a.type==="Course Work"?m.courseworkPrep.push(g):(a.type==="classTest"||a.type==="Class Test")&&m.classtestPrep.push(g)}),m},y=()=>{if(!l.every(a=>!isNaN(parseFloat(a.weightage)))){A.error("Weightage must be a number for all entries");return}if(l.reduce((a,g)=>a+parseFloat(g.weightage),0)!==100){A.error("The sum of weightages must be equal to 100");return}r(o(l)),A.success("Data Saved Successfully")},v=i=>{const m=[...l],a=m.findIndex(S=>i.key===S.key),g=m[a];m.splice(a,1,{...g,...i}),h(m)},n={body:{row:St,cell:wt}},u=x.map(i=>i.editable?{...i,onCell:m=>({record:m,editable:!(m.key==="0"&&(i.dataIndex==="type"||i.dataIndex==="deadline")),dataIndex:i.dataIndex,title:i.title,handleSave:v})}:i);return e.jsxs("div",{children:[e.jsx(ce,{theme:{components:{Table:{headerColor:"white",headerBg:"#27496d",borderColor:"white",rowHoverBg:"none",rowBg:"#051650",colorBgContainer:"#051650"}}},children:e.jsx(ue,{components:n,rowClassName:()=>"editable-row",bordered:!0,pagination:!1,dataSource:l,columns:u})}),e.jsx(ie,{onClick:y,style:{color:"#051650",backgroundColor:"white",fontWeight:"bold",border:"2px solid #b10062",marginTop:"1rem"},children:"Save"})]})},Re=({toggleModal:s,hours:r,secondTableData:l,moduleCode:h,timetabledHours:c,credits:f,newValues:x})=>{const[o,y]=t.useState(),[v,n]=t.useState(),[u,i]=t.useState(1),[m,a]=t.useState("first"),[g,S]=t.useState(!1),[d,w]=t.useState([]),[I,B]=t.useState(),{refetch:L,setRefetch:H}=t.useContext(re),E=[{title:"7.5",value:"7.5"},{title:"15",value:"15"}],R=[{title:1,value:1},{title:2,value:2},{title:3,value:3}],T=[{title:"First",value:"first"},{title:"Second",value:"second"},{title:"Whole Session",value:"whole session"}],[O,G]=t.useState(c),[$,J]=t.useState(f||0);t.useEffect(()=>{x&&(i(x==null?void 0:x.studyYear),a(x==null?void 0:x.semester),S(x==null?void 0:x.optional),w(x==null?void 0:x.programme),B(x==null?void 0:x.title))},[]);const U=p=>{try{return{moduleCode:p.code,moduleCredit:parseInt(p.credits,10),programme:d,studyYear:u,semester:m,title:I,optional:g,timetabledHours:parseInt(p.timetabledHours,10),lectures:parseInt(p.teachingsData.lectures,10),seminars:parseInt(p.teachingsData.seminars,10),tutorials:parseInt(p.teachingsData.tutorials,10),labs:parseInt(p.teachingsData.labs,10),fieldworkPlacement:parseInt(p.teachingsData.fieldwork_placement,10),other:parseInt(p.teachingsData.other,10),examPrep:{weightage:p.assessmentsData.examPrep.weightage,deadline:p.assessmentsData.examPrep.deadline},courseworkPrep:p.assessmentsData.courseworkPrep.map(k=>({weightage:k.weightage,deadline:k.deadline})),classtestPrep:p.assessmentsData.classtestPrep.map(k=>({weightage:k.weightage,deadline:k.deadline}))}}catch(k){console.log(k)}},j=async p=>{try{await te.updateCodes(h,p)&&(A.success("Updated Successfully"),H(L+1),s())}catch{A.error("Please fill all the required fields!")}},N=()=>{j(U({teachingsData:o,assessmentsData:v,timetabledHours:O,credits:$,code:h}))},b=p=>{p.target.checked?w([...d,p.target.name]):w(d==null?void 0:d.filter(k=>k!==p.target.name))};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsx("span",{className:"close-btn",onClick:s,children:"Ã—"}),e.jsxs("div",{className:"inputContainer",children:[e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"Module Code"}),e.jsx("div",{className:"mutipleInput",children:e.jsx("p",{children:h})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"Module Credit"}),e.jsx("div",{id:"Credit",className:"inputSize",children:e.jsx("select",{name:"credit",id:"credit",value:$,onChange:p=>J(p.target.value),children:E==null?void 0:E.map((p,k)=>{var P;return e.jsx("option",{value:p==null?void 0:p.value,defaultValue:(P=E[0])==null?void 0:P.value,children:p.title},k)})})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"TimeTabled Hours"}),e.jsx("div",{id:"timetable",className:"inputSize",children:e.jsx(Z,{onChange:p=>G(p.target.value),value:O,placeholder:"Enter Timetabled Hours",status:r?"":"error"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"Title"}),e.jsx("div",{className:"mutipleInput",children:e.jsx(Z,{onChange:p=>B(p.target.value),placeholder:"Enter Module Code",value:I,status:I?"":"error"})})]})]}),e.jsxs("div",{className:"inputContainer",children:[e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"Study Year"}),e.jsx("div",{id:"Credit",className:"inputSize",children:e.jsx("select",{name:"credit",className:"select_field",value:u,id:"credit",onChange:p=>i(p.target.value),children:R==null?void 0:R.map((p,k)=>{var P;return e.jsx("option",{value:p==null?void 0:p.value,defaultValue:(P=E[0])==null?void 0:P.value,children:p.title},k)})})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"Programme"}),e.jsxs("div",{id:"Programme",className:"programme_checkboxes",children:[e.jsxs("div",{children:[e.jsxs("label",{style:{color:"black"},children:[e.jsx("input",{name:"CSEE",type:"checkbox",checked:d.includes("CSEE"),onChange:b}),"CSEE"]}),e.jsxs("label",{style:{color:"black"},children:[e.jsx("input",{name:"AVS",checked:d.includes("AVS"),type:"checkbox",onChange:b}),"AVS"]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{color:"black"},children:[e.jsx("input",{name:"MCR",checked:d.includes("MCR"),type:"checkbox",onChange:b}),"MCR"]}),e.jsxs("label",{style:{color:"black"},children:[e.jsx("input",{name:"EEE",type:"checkbox",checked:d.includes("EEE"),onChange:b}),"EEE"]})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"Semester"}),e.jsx("div",{id:"Semester",className:"inputSize",children:e.jsx("select",{name:"Semester",id:"semester",value:m,className:"select_field",onChange:p=>a(p.target.value),children:T==null?void 0:T.map((p,k)=>{var P;return e.jsx("option",{value:p==null?void 0:p.value,defaultValue:(P=E[0])==null?void 0:P.value,children:p.title},k)})})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"texti",style:{color:"black"},children:"Optional"}),e.jsx("div",{id:"Credit",className:"inputSize",children:e.jsx("select",{className:"select_field",name:"credit",id:"credit",value:g,onChange:p=>S(p.target.value),children:[{title:"False",value:!1},{title:"True",value:!0}].map((p,k)=>{var P;return e.jsx("option",{value:p==null?void 0:p.value,defaultValue:(P=E[0])==null?void 0:P.value,children:p.title},k)})})})]})]}),e.jsx("div",{className:"table-div",children:e.jsx(Ct,{hours:r,setTeachingsData:y,newValues:x,hoursData:O})}),e.jsx("div",{style:{marginTop:"20px"},children:e.jsx(kt,{data:l,setAssessmentsData:n})}),e.jsx(ie,{onClick:N,style:{color:"white",backgroundColor:"#b10062",fontWeight:"bold",marginTop:"1rem",marginLeft:"80%"},children:"Update"})]})})},Nt=()=>{const[s,r]=t.useState([]),[l,h]=t.useState([]),[c,f]=t.useState({}),[x,o]=t.useState(""),[y,v]=t.useState({}),[n,u]=t.useState(!1),[i,m]=t.useState("moderate"),[a,g]=t.useState(),[S,d]=t.useState(),[w,I]=t.useState(0),[B,L]=t.useState(),[H,E]=t.useState(),[R,T]=t.useState(),[O,G]=t.useState(),[$,J]=t.useState(),U=fe(),{isStudent:j,setPdfPreviewData:N,setGraphSS:b,setFiltersData:p,refetch:k}=t.useContext(re),P=(C,D)=>{if(!C||typeof C!="object")return{hours:0,distribution:[]};if(Array.isArray(C)){const W={};let Y=0;for(const z of C)!z.distribution||!Array.isArray(z.distribution[D])||(z.distribution[D].forEach(M=>{const Q=M.week-1;W[Q]?W[Q].hours+=M.hours:W[Q]={week:M.week,hours:M.hours}}),Y+=z.studyHours||0);return{hours:Y,distribution:Object.values(W)}}else{const W={distribution:C.distribution||[]};return W.hours=C.studyHours===void 0?C.hours||0:C.studyHours,W}},K=async()=>{x==="Select Module"?A.error("Please Select Module"):u(!n)},F=async()=>{const C=document.getElementById("775533"),W=(await Je(C)).toDataURL(),Y=new Image;return Y.src=W,Y};t.useEffect(()=>{x!=="Select Module"&&(async()=>N([c]))()},[c]);async function q(C,D,W){if(Array.isArray(W))return await Promise.all(W.map(async(z,M)=>{const{deadline:Q,weightage:ee}=await z;return{key:C+M,type:D,deadline:"Week"+Q,weightage:ee}}));if(typeof W=="object"&&W!==null){const{deadline:Y,weightage:z}=await W;return[{key:C,type:D,deadline:"Week"+Y,weightage:z}]}else return[]}t.useEffect(()=>{(async()=>{const D=(await te.getCodes()).data.map(W=>W.moduleCode);D.unshift("Select Module"),o(D[0]),h(D)})()},[]),t.useEffect(()=>{x!=="Select Module"&&(async()=>{var Pe,Ie,Te,De,Fe;const C=await te.getSingleCode(x);L((Pe=C==null?void 0:C.data)==null?void 0:Pe.moduleCode),J((Ie=C==null?void 0:C.data)==null?void 0:Ie.moduleCredit),E((Te=C==null?void 0:C.data)==null?void 0:Te.timetabledHours),T((De=C==null?void 0:C.data)==null?void 0:De.totalStudyHours),G((Fe=C==null?void 0:C.data)==null?void 0:Fe.privateStudyHours),f(C.data);const D=await q(w+2,"Class Test",C.data.classtestPrep),W=await q(w+1,"Course Work",C.data.courseworkPrep),z=(await q(w,"Exam",C.data.examPrep)).concat(W,D);let{programme:M,semester:Q,studyYear:ee,title:he,optional:ve}=C.data;d({programme:M,semester:Q,studyYear:ee,title:he,optional:ve}),g(z)})()},[x,k]),t.useEffect(()=>{var z;if(i===void 0)return;if(i===""){r([]);return}if(Object.keys(c).length===0)return;const C=[],D={};["lectures","seminars","tutorials","labs","fieldworkPlacement","other","examPrep","courseworkPrep","classtestPrep"].forEach(M=>{D[M]=P(c[M],i)});let Y={};Object.keys(D).forEach(M=>Y[M]=D[M].hours||0),v(Y);for(let M=1;M<=15;M++){const Q={name:`Week ${M}`,week:M};for(const ee in D)if(ee!=="moduleCode"&&ee!=="moduleCredit"){const he=D[ee];if(he.distribution){const ve=((z=he.distribution.find(Ee=>Ee.week===M))==null?void 0:z.hours)||0;Q[ee]=ve}}C.push(Q)}r(C)},[c,i]);const X=C=>(C/R*100).toFixed(),se=async()=>{if(x==="Select Module")A.error("Please Select Module");else{const C=await F();p(),b({image:C==null?void 0:C.src,module:x,type:i}),U("/preview-pdf")}};return e.jsxs("div",{className:"main-chart-container",children:[n&&e.jsx(Re,{toggleModal:K,hours:y,secondTableData:a,moduleCode:B,credits:$,newValues:S,timetabledHours:H}),e.jsxs("div",{className:"area-chart-container",children:[e.jsx("h1",{className:"firstHeading",children:"Workload Graph"}),e.jsx("div",{className:"chart",id:"775533",children:e.jsx(Ce,{height:380,children:e.jsxs(Me,{data:s,margin:{top:40,right:35,left:20,bottom:5},children:[e.jsx(Ae,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"week",children:e.jsx(oe,{value:"Week",position:"insideBottom",offset:-15})}),e.jsx(we,{domain:[0,"dataMax"],interval:"preserveStart",children:e.jsx(oe,{value:"Study Hours",position:"insideLeft",angle:-90,dy:70})}),e.jsx(ke,{verticalAlign:"bottom",wrapperStyle:{position:"relative",top:"-20px"}}),e.jsx(Ne,{}),e.jsx(_,{type:"monotone",dataKey:"examPrep",stroke:"black",name:"Exam Prep"}),e.jsx(_,{type:"monotone",dataKey:"labHours",stroke:"#FF6B6B",name:"Lab Hours"}),e.jsx(_,{type:"monotone",dataKey:"lectures",stroke:"#66FF66",name:"Lectures"}),e.jsx(_,{type:"monotone",dataKey:"tutorials",stroke:"#4169E1",name:"Tutorials"}),e.jsx(_,{type:"monotone",dataKey:"courseworkPrep",stroke:"red",name:"Coursework Prep"}),e.jsx(_,{type:"monotone",dataKey:"classtestPrep",stroke:"#800080",name:"Class Test Prep"}),e.jsx(_,{type:"monotone",dataKey:"seminars",stroke:"#FFD700",name:"Seminars"}),e.jsx(_,{type:"monotone",dataKey:"fieldworkPlacement",stroke:"#20B2AA",name:"Fieldwork Placement"}),e.jsx(_,{type:"monotone",dataKey:"other",stroke:"#FFA07A",name:"Other"})]})})})]}),e.jsxs("div",{className:"insights-container",children:[e.jsx("h1",{className:"secondHeading",children:"Insights"}),e.jsxs("div",{className:"parent-insights",children:[e.jsxs("div",{className:"progress-1",children:[e.jsx(pe,{percentage:X(H),color:"#051650"}),e.jsx("h2",{className:"h2First",children:"Time Tabled Hours"})]}),e.jsxs("div",{className:"progress-1",children:[e.jsx(pe,{percentage:X(O),color:"#b10062"}),e.jsx("h2",{className:"h2First",children:"Private Study Hours"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},className:"inputt",children:[e.jsx("select",{name:"select_module",id:"select_module",value:x,onChange:C=>o(C.target.value),children:l.map((C,D)=>e.jsx("option",{value:C,children:C},D))}),e.jsxs("select",{name:"study_style",id:"study_style",value:i,onChange:C=>m(C.target.value),children:[e.jsx("option",{value:"Study Style",disabled:!0,children:"Study Style"}),e.jsx("option",{value:"earlybird",children:"Early Bird"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"procrastinator",children:"Procrastinator"})]}),j==="Admin"&&e.jsxs("div",{className:"button-container",children:[e.jsx("div",{className:"details-button-container",children:e.jsxs("button",{className:"details-button",onClick:K,children:[e.jsx("span",{children:" Module Details"}),e.jsx("i",{})," "]})}),e.jsx("div",{className:"preview-pdf-button-container",children:e.jsxs("button",{className:"preview-pdf-button",onClick:se,children:[e.jsx("span",{children:"Preview PDF"}),e.jsx("i",{})]})})]})]})]})]})};const Et=()=>{const{pdfPreviewData:s,graphSS:r,filtersData:l}=t.useContext(re),h=t.useRef(),c=fe();t.useEffect(()=>{s!=null&&s.length||c("/")},[]);const f=()=>{at(h,{filename:"page.pdf"})},x=["Module Code","W1","W2","W3","W4","W5","W6","W7","W8","W9","W10","W11","W12","W13","W14","W15"],o=({examPrep:y,courseworkPrep:v,classtestPrep:n,week:u})=>{let i="";return u===(y==null?void 0:y.deadline)&&(i=e.jsxs(e.Fragment,{children:[e.jsx("pre",{children:"Type: exam"}),e.jsxs("pre",{children:["Hours: ",y==null?void 0:y.studyHours]}),e.jsxs("pre",{children:["Weightage: ",y==null?void 0:y.weightage,"%"]})]})),v.map(m=>{u===(m==null?void 0:m.deadline)&&(i=e.jsxs(e.Fragment,{children:[e.jsx("pre",{children:"Type: coursework"}),e.jsxs("pre",{children:["Hours: ",m==null?void 0:m.studyHours]}),e.jsxs("pre",{children:["Weightage: ",m==null?void 0:m.weightage,"%"]})]}))}),n.map(m=>{u===(m==null?void 0:m.deadline)&&(i=e.jsxs(e.Fragment,{children:[e.jsx("pre",{children:"Type: coursework"}),e.jsxs("pre",{children:["Hours: ",m==null?void 0:m.studyHours]}),e.jsxs("pre",{children:["Weightage: ",m==null?void 0:m.weightage,"%"]})]}))}),i};return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsxs("button",{className:"download-button",onClick:f,children:["Download PDF ",e.jsx(rt,{})]})}),";",e.jsxs("div",{className:"pdf_preview_container",ref:h,children:[l&&e.jsxs("div",{className:"filter_data_holder",children:[e.jsxs("spam",{children:["Year: ",l==null?void 0:l.yearFilter]}),e.jsxs("spam",{children:["Semester: ",l==null?void 0:l.semesterFilter]}),e.jsxs("spam",{children:["Course: ",l==null?void 0:l.courseFilter]})]}),e.jsx("div",{className:"pdf_table_container",children:e.jsxs("table",{className:"pdf_preview_table",children:[e.jsx("thead",{children:e.jsx("tr",{style:{backgroundColor:"#000080",color:"#fff"},children:x==null?void 0:x.map(y=>e.jsx("td",{className:"pdf_table_headers",children:y}))})}),e.jsx("tbody",{children:(s==null?void 0:s.length)&&(s==null?void 0:s.map(y=>{const{examPrep:v,courseworkPrep:n,classtestPrep:u}=y;return e.jsxs("tr",{className:"pdf_table_data",children:[e.jsx("td",{className:"pdf_table_headers",children:y==null?void 0:y.moduleCode}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:1})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:2})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:3})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:4})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:5})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:6})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:7})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:8})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:9})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:10})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:11})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:12})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:13})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:14})}),e.jsx("td",{children:o({examPrep:v,courseworkPrep:n,classtestPrep:u,week:15})})]})}))})]})}),e.jsx("div",{className:"pdf_image_container",children:r&&e.jsxs("div",{children:[e.jsxs("div",{className:"graph_data_holder",children:[e.jsxs("spam",{children:["Module: ",r==null?void 0:r.module]}),e.jsxs("spam",{children:["Study Style: ",r==null?void 0:r.type]})]}),e.jsx("div",{style:{width:"1000px",marginLeft:"250px"},children:e.jsx("img",{style:{width:"75%",height:"auto"},src:r==null?void 0:r.image})})]})})]})]})};const Pt=()=>{const s=(b,p)=>{if(Array.isArray(b)){const k={};let P=0;for(const K of b)K.distribution[p].map(F=>{const q=F.week-1;k[q]?k[q].hours+=F.hours:k[q]={week:F.week,hours:F.hours}}),P+=K.studyHours;return{hours:P,distribution:Object.values(k)}}else{const k={distribution:b.distribution};return b.studyHours===void 0?k.hours=b.hours:k.hours=b.studyHours,k}},[r,l]=t.useState([]),[h,c]=t.useState([]),[f,x]=t.useState({}),o=Xe(),[y,v]=t.useState(o==null?void 0:o.id),[n,u]=t.useState({}),[i,m]=t.useState(!1),[a,g]=t.useState("moderate"),[S,d]=t.useState(),[w,I]=t.useState(0),[B,L]=t.useState(),[H,E]=t.useState(),[R,T]=t.useState(),[O,G]=t.useState(),[$,J]=t.useState(),U=()=>{m(!i)};async function j(b,p,k){const{deadline:P,weightage:K}=await k;return{key:b,type:p,deadline:"Week"+P,weightage:K}}t.useEffect(()=>{(async()=>{const p=(await te.getCodes()).data.map(k=>k.moduleCode);c(p)})()},[]),t.useEffect(()=>{y!==""&&(async()=>{var K,F,q,X,se;const b=await te.getSingleCode(y);L((K=b==null?void 0:b.data)==null?void 0:K.moduleCode),J((F=b==null?void 0:b.data)==null?void 0:F.moduleCredit),E((q=b==null?void 0:b.data)==null?void 0:q.timetabledHours),T((X=b==null?void 0:b.data)==null?void 0:X.totalStudyHours),G((se=b==null?void 0:b.data)==null?void 0:se.privateStudyHours),x(b.data);const p=await j(w+2,"Class Test",b.data.classtestPrep[0]),k=await j(w+1,"Course Work",b.data.courseworkPrep[0]),P=await j(w,"Exam",b.data.examPrep);d([P,k,p])})()},[y]),t.useEffect(()=>{var K;if(a===void 0)return;if(a===""){l([]);return}if(Object.keys(f).length===0)return;const b=[],p={};["lectures","seminars","tutorials","labs","fieldworkPlacement","other","examPrep","courseworkPrep","classtestPrep"].forEach(F=>{p[F]=s(f[F],a)});const P={};Object.keys(p).forEach(F=>P[F]=p[F].hours),u(P);for(let F=1;F<=15;F++){const q={name:`Week ${F}`,week:F};for(const X in p)if(X!=="moduleCode"&&X!=="moduleCredit"){const se=p[X];if(se.distribution){const C=((K=se.distribution.find(D=>D.week===F))==null?void 0:K.hours)||0;q[X]=C}}b.push(q)}l(b)},[f,a]);const N=b=>(b/R*100).toFixed();return e.jsxs("div",{className:"main-chart-container",children:[i&&e.jsx(Re,{toggleModal:U,hours:n,secondTableData:S,moduleCode:B,credits:$,timetabledHours:H}),e.jsxs("div",{className:"area-chart-container",children:[e.jsx("h1",{className:"firstHeading",children:"Workload Graph"}),e.jsx("div",{className:"chart",children:e.jsx(Ce,{height:380,children:e.jsxs(Me,{data:r,margin:{top:40,right:35,left:20,bottom:20},children:[e.jsx(Ae,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"week",children:e.jsx(oe,{value:"Week",position:"insideBottom",offset:-15})}),e.jsx(we,{domain:[0,"dataMax"],interval:"preserveStart",children:e.jsx(oe,{value:"Study Hours",position:"insideLeft",angle:-90})}),e.jsx(ke,{verticalAlign:"bottom",wrapperStyle:{position:"relative",top:"-20px"}}),e.jsx(Ne,{}),e.jsx(_,{type:"monotone",dataKey:"examPrep",stroke:"black",name:"Exam Prep"}),e.jsx(_,{type:"monotone",dataKey:"labHours",stroke:"#FF6B6B",name:"Lab Hours"}),e.jsx(_,{type:"monotone",dataKey:"lectures",stroke:"#66FF66",name:"Lectures"}),e.jsx(_,{type:"monotone",dataKey:"tutorials",stroke:"#4169E1",name:"Tutorials"}),e.jsx(_,{type:"monotone",dataKey:"courseworkPrep",stroke:"red",name:"Coursework Prep"}),e.jsx(_,{type:"monotone",dataKey:"classtestPrep",stroke:"#800080",name:"Class Test Prep"}),e.jsx(_,{type:"monotone",dataKey:"seminars",stroke:"#FFD700",name:"Seminars"}),e.jsx(_,{type:"monotone",dataKey:"fieldworkPlacement",stroke:"#20B2AA",name:"Fieldwork Placement"}),e.jsx(_,{type:"monotone",dataKey:"other",stroke:"#FFA07A",name:"Other"})]})})})]}),e.jsxs("div",{className:"insights-container",children:[e.jsx("h1",{className:"secondHeading",children:"Insights"}),e.jsxs("div",{className:"parent-insights",children:[e.jsxs("div",{className:"progress-1",children:[e.jsx(pe,{percentage:N(H),color:"#051650"}),e.jsx("h2",{className:"h2First",children:"Time Tabled Hours"})]}),e.jsxs("div",{className:"progress-1",children:[e.jsx(pe,{percentage:N(O),color:"#b10062"}),e.jsx("h2",{className:"h2First",children:"Private Study Hours"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},className:"inputt",children:[e.jsx("p",{children:o==null?void 0:o.id}),e.jsxs("select",{name:"",id:"",defaultValue:a,onChange:b=>g(b.target.value),children:[e.jsx("option",{value:"earlybird",children:"Early Bird"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"procrastinator",children:"Procrastinator"})]})]})]})]})},It=[{value:"CSEE",label:"CSEE"},{value:"MCR",label:"MCR"},{value:"AVS",label:"AVS"},{value:"EEE",label:"EEE"}],Tt=[{value:1,label:"Year 1"},{value:2,label:"Year 2"},{value:3,label:"Year 3"}],Dt=[{value:"first",label:"First"},{value:"second",label:"Second"}],Oe={CSEE:"#4e79a7",MCR:"#f28e2c",AVS:"#e15759",EEE:"#76b7b2"},Ft=()=>{const s="0123456789ABCDEF";let r="#",l=!1;for(;!l;){r="#";for(let h=0;h<6;h++)r+=s[Math.floor(Math.random()*16)];l=!Object.values(Oe).includes(r)}return r},Wt=(s,r,l,h,c)=>{let f=[];return s.forEach(x=>{const o=r.some(u=>u.value===x.moduleCode),y=x.programme.some(u=>l.map(i=>i.value).includes(u)),v=h.length===0||h.some(u=>u.value===x.studyYear),n=c.length===0||c.some(u=>u.value===x.semester);v&&n&&(o||y)&&x.totalHours.forEach(u=>{let i=f.find(m=>m.week===`Week ${u.week}`);if(i||(i={week:`Week ${u.week}`},f.push(i)),o){const m=x.moduleCode;i[m]=(i[m]||0)+u.hours}y&&!o&&x.programme.forEach(m=>{l.map(a=>a.value).includes(m)&&(i[m]=(i[m]||0)+u.hours)})})}),f.sort((x,o)=>parseInt(x.week.split(" ")[1])-parseInt(o.week.split(" ")[1]))};const Mt=()=>{const[s,r]=t.useState([]),[l,h]=t.useState([]),[c,f]=t.useState([]),[x,o]=t.useState([]),[y,v]=t.useState([]),[n,u]=t.useState("bar"),i=t.useRef({});t.useEffect(()=>{(async()=>{try{const d=await te.getCodes();r(d.data),d.data.forEach(w=>{i.current[w.moduleCode]||(i.current[w.moduleCode]=Ft())})}catch(d){console.error("Failed to fetch modules data:",d)}})()},[]),t.useMemo(()=>s.map(S=>({value:S.moduleCode,label:S.moduleCode})),[s]);const m=t.useMemo(()=>s.map(S=>({value:S.moduleCode,label:S.moduleCode})),[s]),a=t.useMemo(()=>Wt(s,c,l,x,y),[s,c,l,x,y]),g=()=>{const S=n==="bar"?tt:st;return e.jsx(Ce,{width:"100%",height:400,children:e.jsxs(S,{data:a,margin:{top:40,right:35,left:30,bottom:5},children:[e.jsx(Se,{dataKey:"week",tickFormatter:d=>d.replace(/^Week\s/,""),children:e.jsx(oe,{value:"Week",position:"insideBottom",offset:-15})}),e.jsx(we,{label:{value:"Total Study Hours",angle:-90,position:"insideLeft",dy:90,dx:-15}}),e.jsx(Ne,{}),e.jsx(ke,{verticalAlign:"bottom",wrapperStyle:{position:"relative",top:"-5px"}}),a[0]&&Object.keys(a[0]).filter(d=>d!=="week").map(d=>{let w=Oe[d];if(!w){const I=d.match(/\(([^)]+)\)$/),B=I?I[1]:d;w=i.current[B]||"#F00"}return n==="bar"?e.jsx(Ze,{dataKey:d,stackId:"a",fill:w,name:d},d):e.jsx(et,{dataKey:d,stackId:"a",stroke:w,fill:w,name:d},d)})]})})};return e.jsxs("div",{className:"stacked-graph-main-container",children:[e.jsxs("div",{className:"stacked-graph-area-container",children:[e.jsx("h1",{className:"stacked-graph-heading",children:"Stacked Graph"}),e.jsx("div",{className:"stacked-graph-chart-area",children:e.jsx("div",{className:"stacked-graph-responsive-container chart",children:g()})})]}),e.jsxs("div",{className:"stacked-graph-insights-container",children:[e.jsx("h2",{className:"stacked-graph-subheading",children:"Insights"}),e.jsxs("div",{className:"stacked-graph-chart-type-selector",children:[e.jsx("label",{className:"stacked-graph-label",children:"Graph Type"}),e.jsxs("div",{className:"graph-type-icons",children:[e.jsx(We,{className:`graph-type-icon ${n==="bar"?"active":""}`,onClick:()=>u("bar"),style:{marginRight:"10px",backgroundColor:n==="bar"?"#007bff":"transparent"},children:e.jsx(lt,{sx:{color:n==="bar"?"#fff":"#000",fontSize:50}})}),e.jsx(We,{className:`graph-type-icon ${n==="line"?"active":""}`,onClick:()=>u("line"),style:{backgroundColor:n==="line"?"#007bff":"transparent"},children:e.jsx(nt,{sx:{color:n==="line"?"#fff":"#000",fontSize:50}})})]})]}),e.jsxs("div",{className:"stacked-graph-input-container",children:[e.jsx(xe,{isMulti:!0,options:It,value:l,onChange:h,placeholder:"Select Programmes",className:"stacked-graph-select filter-select",classNamePrefix:"select"}),e.jsx(xe,{isMulti:!0,options:m,value:c,onChange:f,placeholder:"Select Modules",className:"stacked-graph-select filter-select",classNamePrefix:"select"}),e.jsx(xe,{isMulti:!0,options:Tt,value:x,onChange:o,placeholder:"Select Year",className:"stacked-graph-select filter-select",classNamePrefix:"select"}),e.jsx(xe,{isMulti:!0,options:Dt,value:y,onChange:v,placeholder:"Select Semester",className:"stacked-graph-select filter-select",classNamePrefix:"select"})]})]})]})};function At(){return e.jsxs("div",{style:{background:"linear-gradient(to right, #0f0c29, #302b63, #24243e)",height:"100vh"},children:[e.jsxs(Ge,{children:[e.jsx(jt,{}),e.jsxs(Qe,{children:[e.jsx(ae,{path:"/",element:e.jsx(gt,{})}),e.jsx(ae,{path:"/select-course",element:e.jsx(pt,{})}),e.jsx(ae,{path:"/previous-courses",element:e.jsx(ft,{})}),e.jsx(ae,{path:"/simulations",element:e.jsx(Nt,{})}),e.jsx(ae,{path:"/preview-pdf",element:e.jsx(Et,{})}),e.jsx(ae,{path:"/insight/:id",element:e.jsx(Pt,{})}),e.jsx(ae,{path:"/stacked-simulations",element:e.jsx(Mt,{})})]})]}),e.jsx(ze,{})]})}Le.createRoot(document.getElementById("root")).render(e.jsx(de.StrictMode,{children:e.jsx(ot,{children:e.jsx(At,{})})}));
